driftfile <%= scope.lookupvar('ntp::params::driftfile') %>

statistics loopstats peerstats clockstats
filegen loopstats file loopstats type day enable
filegen peerstats file peerstats type day enable
filegen clockstats file clockstats type day enable

# Configure external time sources
<% ntp_servers.each do |val| -%>
server <%= val %> iburst
<% end -%>

# Access control
restrict -4 default kod notrap nomodify nopeer noquery
restrict -6 default kod notrap nomodify nopeer noquery
<% restrict_addresses.each do |val| -%>
restrict <%= val %>
<% end -%>

<% if @orphan_line -%>
# An ntpd acting as a server for other ntp daemons needs a fallback in case it 
# loses connectivity to external time sources - hence the "tos orphan <stratum>" 
# entry.
<%= orphan_line %>
<% end %>

<% if @peer_line -%>
# Co-operate with another ntpd peer
<%= peer_line %>
<% end %>
